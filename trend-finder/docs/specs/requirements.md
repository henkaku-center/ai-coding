# 要件定義書：トレンド分析・コンテンツ提案システム

## 1. プロジェクト概要

### 1.1 プロジェクト名
トレンドファインダー（Trend Finder）

### 1.2 概要
Web上のトレンドデータをスクレイピング・分析し、**いま出せば読まれる記事テーマ**や**いまプロモーションすれば売れる書籍**を提案するシステム。記念日・バズるハッシュタグ調査ツールからの発展形として、より包括的なトレンド分析を実現する。

### 1.3 対象ユーザー
- ブロガー、ライター（記事テーマを探している）
- 編集者、メディア運営者（読まれるコンテンツを企画したい）
- マーケター、出版関係者（書籍プロモーションのタイミングを計りたい）

---

## 2. 目的・背景

### 2.1 解決したい課題
- **課題1**: 記事を書いても読まれるタイミングがわからない
- **課題2**: 話題になっているトピックを手動で調べるのは時間がかかる
- **課題3**: 書籍プロモーションの最適なタイミングを逃している

### 2.2 目的
- リアルタイムのトレンドを自動収集・分析
- データに基づいたコンテンツ提案
- タイムリーなアクション（記事執筆、プロモーション）を支援

---

## 3. 機能要件

### 3.1 トレンドデータ収集機能

#### 3.1.1 ハッシュタグトレンド収集
- **機能**: SNS（Twitter/X）のトレンドハッシュタグを定期的に収集
- **データ項目**: ハッシュタグ名、ツイート数、時刻、関連キーワード
- **頻度**: 1時間ごと
- **受け入れ基準**:
  - [ ] トレンドハッシュタグを上位20件取得できる
  - [ ] 取得データにタイムスタンプが含まれている
  - [ ] 取得失敗時にリトライ処理が動作する

#### 3.1.2 記念日・イベント情報収集
- **機能**: カレンダー情報から記念日やイベントを収集
- **データ項目**: 日付、記念日名称、説明、カテゴリ
- **頻度**: 週1回更新
- **受け入れ基準**:
  - [ ] 年間を通した記念日データを取得できる
  - [ ] カテゴリ（文化、スポーツ、季節など）で分類できる

#### 3.1.3 ニュース・話題の収集
- **機能**: ニュースサイトやまとめサイトから話題のトピックを収集
- **データ項目**: タイトル、概要、カテゴリ、公開日時、ソースURL
- **頻度**: 6時間ごと
- **受け入れ基準**:
  - [ ] 複数のニュースソースから情報を取得できる
  - [ ] 重複記事を除外できる
  - [ ] カテゴリ分類（政治、経済、エンタメ、テクノロジーなど）ができる

### 3.2 トレンド分析機能

#### 3.2.1 トレンドスコア算出
- **機能**: 収集したデータから各トピックの「話題度スコア」を算出
- **算出要素**: メンション数、増加率、拡散速度、時間的新鮮度
- **受け入れ基準**:
  - [ ] 各トピックに0-100のスコアを付与できる
  - [ ] 急上昇トレンドを検出できる（前日比200%以上など）
  - [ ] スコアの算出根拠を説明できる

#### 3.2.2 時系列分析
- **機能**: トレンドの推移を時系列で分析
- **分析項目**: ピーク時刻、継続時間、衰退速度
- **受け入れ基準**:
  - [ ] トレンドの開始・ピーク・終了を判定できる
  - [ ] 24時間以内に衰退するトレンドと長期継続トレンドを区別できる

#### 3.2.3 関連性分析
- **機能**: トピック間の関連性を分析
- **出力**: 共起キーワード、関連ハッシュタグ、関連記事
- **受け入れ基準**:
  - [ ] あるトピックに対して関連度の高いキーワードを5件以上抽出できる
  - [ ] 関連性スコアを算出できる

### 3.3 記事テーマ提案機能

#### 3.3.1 記事テーマ生成
- **機能**: 分析結果から「いま書けば読まれる記事テーマ」を提案
- **提案内容**: 記事タイトル案、切り口、想定読者、推奨公開タイミング
- **受け入れ基準**:
  - [ ] 1回の実行で5件以上の記事テーマ案を提案できる
  - [ ] 各提案に「なぜ今がタイミングか」の根拠を付与できる
  - [ ] トレンドスコア上位のトピックから優先的に提案できる

#### 3.3.2 カテゴリ別提案
- **機能**: ユーザーが指定したカテゴリに絞った提案
- **対応カテゴリ**: テクノロジー、ビジネス、エンタメ、ライフスタイルなど
- **受け入れ基準**:
  - [ ] カテゴリを指定して提案を絞り込める
  - [ ] カテゴリ未指定時は全カテゴリから提案する

### 3.4 書籍プロモーション提案機能

#### 3.4.1 プロモーションタイミング提案
- **機能**: 既存の書籍に対して「いまプロモーションすべきか」を判定
- **入力**: 書籍タイトル、キーワード、ジャンル
- **出力**: プロモーション推奨度（高/中/低）、理由、推奨期間
- **受け入れ基準**:
  - [ ] 書籍のキーワードとトレンドの関連性を判定できる
  - [ ] プロモーション推奨度を3段階で評価できる
  - [ ] 「今週中がチャンス」など具体的な期間を提示できる

#### 3.4.2 関連トレンドのアラート
- **機能**: 登録した書籍のキーワードに関連するトレンドが発生した際に通知
- **通知方法**: コンソール出力、ファイル保存、（将来的にメール/Slack）
- **受け入れ基準**:
  - [ ] 書籍キーワードを事前登録できる
  - [ ] 関連トレンド発生時に通知を生成できる
  - [ ] 通知履歴を確認できる

### 3.5 レポート生成機能

#### 3.5.1 日次レポート
- **機能**: 毎日のトレンドサマリーを生成
- **内容**: トップトレンド、急上昇ワード、記事提案、書籍プロモーション提案
- **形式**: Markdown、JSON
- **受け入れ基準**:
  - [ ] 自動で日次レポートを生成できる
  - [ ] レポートに前日比の変化を含められる
  - [ ] 読みやすいフォーマットで出力される

#### 3.5.2 週次レポート
- **機能**: 週単位のトレンド推移レポート
- **内容**: 週間トップトレンド、継続トレンド、新規トレンド
- **受け入れ基準**:
  - [ ] 週単位で集計できる
  - [ ] トレンドの継続日数を表示できる

### 3.6 データ管理機能

#### 3.6.1 データ保存
- **機能**: 収集したデータを構造化して保存
- **保存形式**: JSON、CSV、またはデータベース
- **受け入れ基準**:
  - [ ] データを日付別に整理して保存できる
  - [ ] 過去データを参照できる
  - [ ] データの重複を防げる

#### 3.6.2 データクレンジング
- **機能**: ノイズや重複データを除去
- **受け入れ基準**:
  - [ ] 同一トピックの重複を除去できる
  - [ ] スパム的なトレンドをフィルタリングできる

---

## 4. 非機能要件

### 4.1 パフォーマンス
- トレンド収集は1ソースあたり5秒以内に完了すること
- 分析処理は1回あたり30秒以内に完了すること
- レポート生成は10秒以内に完了すること

### 4.2 信頼性
- スクレイピング失敗時はリトライ（最大3回）すること
- エラーログを記録すること
- 部分的な失敗でもシステム全体は継続動作すること

### 4.3 セキュリティ
- APIキーやトークンは環境変数または設定ファイルで管理すること
- .env ファイルは .gitignore に含めること
- スクレイピング対象サイトの利用規約を遵守すること

### 4.4 保守性
- コードは TypeScript で型安全に実装すること
- 関数・変数名は読みやすく意図が明確であること
- 各機能は独立したモジュールとして実装すること

### 4.5 拡張性
- 新しいデータソースを容易に追加できる設計であること
- 分析アルゴリズムを差し替え可能にすること
- 通知方法を後から追加できること

---

## 5. 制約事項

### 5.1 技術的制約
- スクレイピングは robots.txt を尊重すること
- APIレート制限を考慮し、適切な間隔でリクエストすること
- 短時間に大量のリクエストを送信しないこと（最小間隔: 1秒）

### 5.2 運用制約
- スクレイピング対象サイトの仕様変更に対応する必要がある
- 無料APIの制限内で動作させる（有料APIは将来検討）

### 5.3 法的制約
- 著作権法を遵守すること
- 取得したデータの二次利用は私的利用の範囲とすること
- スクレイピング先の利用規約を定期的に確認すること

---

## 6. 受け入れ基準（全体）

### 6.1 最小機能セット（MVP）
以下の機能が動作すれば MVP として受け入れ可能：
- [ ] 少なくとも1つのソース（Twitter/Xトレンドまたはニュースサイト）からデータを取得できる
- [ ] 取得したデータにトレンドスコアを付与できる
- [ ] 記事テーマ提案を3件以上生成できる
- [ ] 日次レポートをMarkdown形式で出力できる

### 6.2 完全版
以下の機能がすべて動作すれば完全版として受け入れ可能：
- [ ] 3.1〜3.6の全機能要件を満たす
- [ ] 4.1〜4.5の非機能要件を満たす
- [ ] 5.1〜5.3の制約事項を遵守している
- [ ] エラー処理が適切に実装されている
- [ ] README にセットアップ手順と使い方が記載されている

---

## 7. 用語集

| 用語 | 説明 |
|------|------|
| トレンド | 短期間に急激に注目を集めている話題やキーワード |
| トレンドスコア | トピックの話題度を数値化したもの（0-100） |
| 急上昇トレンド | 前日比で大幅に増加したトレンド |
| スクレイピング | Webサイトから情報を自動収集する技術 |
| 記事テーマ | ブログ記事や記事の主題・タイトル案 |
| プロモーション推奨度 | 書籍をプロモーションすべきタイミングかどうかの評価 |
| MVP | Minimum Viable Product（最小限の機能を持つ製品） |

---

## 8. 変更履歴

| 日付 | バージョン | 変更内容 | 作成者 |
|------|------------|----------|--------|
| 2025-11-24 | 1.0 | 初版作成 | - |
